<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Test for Marginal Independence — MI.test • MRCV</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Test for Marginal Independence — MI.test"><meta name="description" content="The MI.test function offers three approaches for testing multiple
marginal independence (MMI) between one SRCV and one MRCV, or simultaneous
pairwise marginal independence (SPMI) between two MRCVs."><meta property="og:description" content="The MI.test function offers three approaches for testing multiple
marginal independence (MMI) between one SRCV and one MRCV, or simultaneous
pairwise marginal independence (SPMI) between two MRCVs."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MRCV</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.5-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-file-o"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/Koziol_Bilder_2014.pdf">Koziol and Bilder (2014)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/chrisbilder/MRCV" aria-label="GitHub repository"><span class="fa fa-github"></span> GitHub</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.researchgate.net/profile/Muhammad_Yaseen10" aria-label="ResearchGate"><span class="fa fa-github"></span> ResearchGate</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/chrisbilder" aria-label="Twitter"><span class="fa fab fa-twitter"></span> Twitter</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Test for Marginal Independence</h1>

      <div class="d-none name"><code>MI.test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>MI.test</code> function offers three approaches for testing multiple
marginal independence (MMI) between one SRCV and one MRCV, or simultaneous
pairwise marginal independence (SPMI) between two MRCVs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MI.test</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">I</span>,</span>
<span>  <span class="va">J</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1999</span>,</span>
<span>  B.max <span class="op">=</span> <span class="va">B</span>,</span>
<span>  summary.data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add.constant <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  plot.hist <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  print.status <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>For <code>summary.data = FALSE</code>: a data frame containing the raw
data where rows correspond to the individual item response vectors, and
columns correspond to the items, W1, ..., WI and Y1, ..., YJ (in this
order).</p>
<p>For <code>summary.data = TRUE</code>: a data frame containing 4 columns
generically named <code>W</code>, <code>Y</code>, <code>yj</code>, and <code>count</code> (one MRCV
case), or 5 columns named <code>W</code>, <code>Y</code>, <code>wi</code>, <code>yj</code>, and
<code>count</code> (two MRCV case).</p></dd>


<dt id="arg-i">I<a class="anchor" aria-label="anchor" href="#arg-i"></a></dt>
<dd><p>The number of items corresponding to row variable W.  I = 1 for the
one MRCV case.</p></dd>


<dt id="arg-j">J<a class="anchor" aria-label="anchor" href="#arg-j"></a></dt>
<dd><p>The number of items corresponding to column variable Y.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A character string specifying one of the following approaches
for testing for MI: <code>"boot"</code> specifies a nonparametric bootstrap
procedure; <code>"rs2"</code> specifies a Rao-Scott second-order adjustment;
<code>"bon"</code> specifies a Bonferroni adjustment; <code>"all"</code> specifies all
three approaches.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>The desired number of bootstrap resamples.</p></dd>


<dt id="arg-b-max">B.max<a class="anchor" aria-label="anchor" href="#arg-b-max"></a></dt>
<dd><p>The maximum number of bootstrap resamples.  A resample is
thrown out if at least one of the J (one MRCV case) or IxJ (two MRCV case)
contingency tables does not have the correct dimension; <code>MI.test</code> uses
the first <code>B</code> valid resamples or all valid resamples if that number is
less than <code>B</code>.</p></dd>


<dt id="arg-summary-data">summary.data<a class="anchor" aria-label="anchor" href="#arg-summary-data"></a></dt>
<dd><p>A logical value indicating whether <code>data</code> is a
summary file containing the item response data instead of the raw data.
Only <code>type = "bon"</code> is available for <code>summary.data = TRUE</code>.</p></dd>


<dt id="arg-add-constant">add.constant<a class="anchor" aria-label="anchor" href="#arg-add-constant"></a></dt>
<dd><p>A positive constant to be added to all zero marginal
cell counts.</p></dd>


<dt id="arg-plot-hist">plot.hist<a class="anchor" aria-label="anchor" href="#arg-plot-hist"></a></dt>
<dd><p>A logical value indicating whether plots of the emprical
bootstrap sampling distributions should be provided.</p></dd>


<dt id="arg-print-status">print.status<a class="anchor" aria-label="anchor" href="#arg-print-status"></a></dt>
<dd><p>A logical value indicating whether bootstrap progress
updates should be provided.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>— <code>MI.test</code> returns a list containing at least
<code>general</code>, a list containing the following objects:</p><ul><li><p><code>data</code>: The original data frame supplied to the <code>data</code>
argument.</p></li>
<li><p><code>I</code>: The original value supplied to the <code>I</code>
argument.</p></li>
<li><p><code>J</code>: The original value supplied to the <code>J</code>
argument.</p></li>
<li><p><code>summary.data</code>: The original value supplied to the
<code>summary.data</code> argument.</p></li>
<li><p><code>X.sq.S</code>: The modified Pearson
statistic; NA if at least one of the J (one MRCV case) or IxJ (two MRCV
case) contingency tables does not have the correct dimension.</p></li>
<li><p><code>X.sq.S.ij</code>: A matrix containing the individual Pearson
statistics.</p></li>
</ul><p>— For <code>type = "boot"</code>, the primary list additionally includes
<code>boot</code>, a list containing the following objects:</p><ul><li><p><code>B.use</code>: The number of bootstrap resamples used.</p></li>
<li><p><code>B.discard</code>: The number of bootstrap resamples discarded due to
having at least one contingency table with incorrect dimension.</p></li>
<li><p><code>p.value.boot</code>: The bootstrap p-value for the test of MMI or SPMI.</p></li>
<li><p><code>p.combo.min.boot</code>: The bootstrap p-value for the minimum p-value
combination method.</p></li>
<li><p><code>p.combo.prod.boot</code>: The bootstrap p-value for
the product p-value combination method.</p></li>
<li><p><code>X.sq.S.star</code>: A numeric
vector containing the modified Pearson statistics calculated for each
resample.</p></li>
<li><p><code>X.sq.S.ij.star</code>: A matrix containing the individual
Pearson statistics calculated for each resample.</p></li>
<li><p><code>p.combo.min.star</code>: A numeric vector containing the minimum
p-value calculated for each resample.</p></li>
<li><p><code>p.combo.prod.star</code>: A
numeric vector containing the product p-value calculated for each resample.</p></li>
</ul><p>— For <code>type = "rs2"</code>, the primary list additionally includes
<code>rs2</code>, a list containing the following objects:</p><ul><li><p><code>X.sq.S.rs2</code>: The Rao-Scott second-order adjusted Pearson
statistic.</p></li>
<li><p><code>df.rs2</code>: The degrees of freedom for testing the
second-order Rao-Scott adjusted Pearson statistic.</p></li>
<li><p><code>p.value.rs2</code>:
The p-value based on the Rao-Scott second-order adjustment.</p></li>
</ul><p>— For <code>type = "bon"</code>, the primary list additionally includes
<code>bon</code>, a list containing the following objects:</p><ul><li><p><code>p.value.bon</code>: The Bonferroni adjusted p-value for the test of MMI
or SPMI.</p></li>
<li><p><code>X.sq.S.ij.p.bon</code>: A matrix containing the Bonferroni
adjusted p-values for the individual Pearson statistics.</p></li>
</ul><p>— For <code>type = "all"</code>, the list includes all of the above objects.</p>
<p>— <code>MI.stat</code> returns a list containing the following objects:</p><ul><li><p><code>X.sq.S</code>: Defined above.</p></li>
<li><p><code>X.sq.S.ij</code>: Defined
above.</p></li>
<li><p><code>valid.margins</code>: The number of contingency tables with
correct dimension.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>MI.test</code> function calls <code>MI.stat</code> to calculate a modified
Pearson statistic (see Bilder, Loughin, and Nettleton (2000) and Bilder and
Loughin (2004)), and then performs the testing of MMI or SPMI.  Three sets
of testing methods are implemented:</p><ul><li><p>The nonparametric
bootstrap resamples under the null hypothesis by independently sampling the
W and Y vectors with replacement from the observed data.  Fixed row counts
(i.e., fixed counts for each level of the SRCV) are maintained for the one
MRCV case.  A modified Pearson statistic is calculated for each resample.
In addition, bootstrap p-value combination methods are available to take
advantage of the modified Pearson statistic's decomposition into J (one MRCV
case) or IxJ (two MRCV case) individual Pearson statistics.  The minimum or
the product of p-values is the combination for each resample.</p></li>
<li><p>The
Rao-Scott approach applies a second-order adjustment to the modified Pearson
statistic and its sampling distribution.  Formulas are provided in Appendix
A of Bilder, Loughin, and Nettleton (2000) and Bilder and Loughin (2004).
Note that this test can be conservative at times.</p></li>
<li><p>The Bonferroni
adjustment multiplies each p-value (using a standard chi-square
approximation) from the individual Pearson statistics by J (one MRCV case)
or IxJ (two MRCV case).  If a resulting p-value is greater than 1 after the
multiplication, it is set to a value of 1.  The overall p-value for the test
then is the minimum of these adjusted p-values.  Note that the Bonferroni
adjustment tends to produce an overly conservative test when the number of
individual Pearson statistics is large.</p></li>
</ul><p>Agresti and Liu (1999) discuss a marginal logit model approach that uses
generalized estimation equations (GEE) to test for MMI.  As shown in the
example given below, this approach can be performed via functions available
from the <b>geepack</b> package.  However, Bilder, Loughin, and Nettleton
(2000) caution that the Wald test produced by this approach does not hold
the correct size, particularly when the sample size is not large and
marginal probabilities are small.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Agresti, A. and Liu, I.-M. (1999) Modeling a categorical
variable allowing arbitrarily many category choices.  <em>Biometrics</em>,
<b>55</b>, 936–943.</p>
<p>Bilder, C. and Loughin, T. (2004) Testing for marginal independence between
two categorical variables with multiple responses.  <em>Biometrics</em>,
<b>36</b>, 433–451.</p>
<p>Bilder, C., Loughin, T., and Nettleton, D. (2000) Multiple marginal
independence testing for pick any/c variables.  <em>Communications in
Statistics–Theory and Methods</em>, <b>29</b>, 1285–1316.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The <code><a href="genloglin.html">genloglin</a></code> function offers a generalized loglinear
modeling approach for testing the relationship among two or three MRCVs.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test for MMI using the second-order Rao-Scott adjustment</span></span></span>
<span class="r-in"><span><span class="va">test.mmi.rs2</span> <span class="op">&lt;-</span> <span class="fu">MI.test</span><span class="op">(</span>data <span class="op">=</span> <span class="va">farmer1</span>, I <span class="op">=</span> <span class="fl">1</span>, J <span class="op">=</span> <span class="fl">5</span>, type <span class="op">=</span> <span class="st">"rs2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test.mmi.rs2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Multiple Marginal Independence (MMI) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unadjusted Pearson Chi-Square Tests for Independence: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X^2_S = 30.84 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X^2_S.ij = </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Y1   Y2   Y3   Y4    Y5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5.96 7.89 4.62 1.42 10.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Second-Order Rao-Scott Adjusted Results: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X^2_S.adj = 28.68 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> df.adj = 18.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.adj = 0.0632 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test for MMI using all three approaches</span></span></span>
<span class="r-in"><span><span class="co"># A small B is used for demonstration purposes; normally, a larger B should be used</span></span></span>
<span class="r-in"><span><span class="va">test.mmi.all</span> <span class="op">&lt;-</span> <span class="fu">MI.test</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">farmer1</span>, I <span class="op">=</span> <span class="fl">1</span>, J <span class="op">=</span> <span class="fl">5</span>, type <span class="op">=</span> <span class="st">"all"</span>, B <span class="op">=</span> <span class="fl">99</span>,</span></span>
<span class="r-in"><span>  plot.hist <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap Progress: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-plt img"><img src="MI.test-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">test.mmi.all</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Multiple Marginal Independence (MMI) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unadjusted Pearson Chi-Square Tests for Independence: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X^2_S = 30.84 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X^2_S.ij = </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Y1   Y2   Y3   Y4    Y5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5.96 7.89 4.62 1.42 10.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap Results: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Final results based on 99 resamples </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.boot = 0.0606 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.combo.prod = 0.0505 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.combo.min = 0.202 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Second-Order Rao-Scott Adjusted Results: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X^2_S.adj = 28.68 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> df.adj = 18.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.adj = 0.0632 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bonferroni Adjusted Results: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.adj = 0.1357 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.ij.adj = </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Y1     Y2     Y3     Y4     Y5    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.0000 0.4778 1.0000 1.0000 0.1357</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use MI.test() with summary data</span></span></span>
<span class="r-in"><span><span class="co"># Convert raw data file to summary file for this example</span></span></span>
<span class="r-in"><span><span class="va">farmer1.irdframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="item.response.table.html">item.response.table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">farmer1</span>, I <span class="op">=</span> <span class="fl">1</span>, J <span class="op">=</span> <span class="fl">5</span>, create.dataframe <span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Test for MMI using the Bonferroni adjustment</span></span></span>
<span class="r-in"><span><span class="va">test.mmi.bon</span> <span class="op">&lt;-</span> <span class="fu">MI.test</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">farmer1.irdframe</span>, I <span class="op">=</span> <span class="fl">1</span>, J <span class="op">=</span> <span class="fl">5</span>, type <span class="op">=</span> <span class="st">"bon"</span>,</span></span>
<span class="r-in"><span>  summary.data <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test.mmi.bon</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Multiple Marginal Independence (MMI) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unadjusted Pearson Chi-Square Tests for Independence: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X^2_S = 30.84 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X^2_S.ij = </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Y1   Y2   Y3   Y4    Y5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5.96 7.89 4.62 1.42 10.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bonferroni Adjusted Results: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.adj = 0.1357 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.ij.adj = </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Y1     Y2     Y3     Y4     Y5    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.0000 0.4778 1.0000 1.0000 0.1357</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test for SPMI using the second-order Rao-Scott adjustment</span></span></span>
<span class="r-in"><span><span class="va">test.spmi.rs2</span> <span class="op">&lt;-</span> <span class="fu">MI.test</span><span class="op">(</span>data <span class="op">=</span> <span class="va">farmer2</span>, I <span class="op">=</span> <span class="fl">3</span>, J <span class="op">=</span> <span class="fl">4</span>, type <span class="op">=</span> <span class="st">"rs2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test.spmi.rs2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Simultaneous Pairwise Marginal Independence (SPMI) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unadjusted Pearson Chi-Square Tests for Independence: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X^2_S = 64.03 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X^2_S.ij = </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       y1   y2    y3   y4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> w1  4.93 2.93 14.29 0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> w2  6.56 2.11 11.68 0.13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> w3 13.98 0.00  7.08 0.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Second-Order Rao-Scott Adjusted Results: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X^2_S.adj = 36.17 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> df.adj = 6.78 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.adj &lt; 0.0001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test for MMI using the marginal logit model approach</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">geepack</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">farmer1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">farmer1.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>case <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">farmer1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Reshape raw data into long format as required by geeglm() function</span></span></span>
<span class="r-in"><span><span class="co"># Assumes 3:ncol(farmer1.id) corresponds to MRCV items</span></span></span>
<span class="r-in"><span><span class="va">farmer1.gee</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">farmer1.id</span>,</span></span>
<span class="r-in"><span>  varying <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">farmer1.id</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">farmer1.id</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  v.names <span class="op">=</span> <span class="st">"response"</span>, timevar <span class="op">=</span> <span class="st">"item"</span>, idvar <span class="op">=</span> <span class="st">"case"</span>,</span></span>
<span class="r-in"><span>  direction <span class="op">=</span> <span class="st">"long"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">farmer1.gee</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="va">farmer1.gee</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">farmer1.gee</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">factor</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Data frame must be ordered by case</span></span></span>
<span class="r-in"><span><span class="va">farmer1.gee</span> <span class="op">&lt;-</span> <span class="va">farmer1.gee</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">farmer1.gee</span><span class="op">$</span><span class="va">case</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">farmer1.gee</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      case Ed item response</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1  1    1        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 263     1  1    2        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 525     1  1    3        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 787     1  1    4        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1049    1  1    5        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       2  4    1        0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">farmer1.gee</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      case Ed item response</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1309  261  3    5        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 262   262  1    1        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 524   262  1    2        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 786   262  1    3        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1048  262  1    4        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1310  262  1    5        1</span>
<span class="r-in"><span><span class="va">mod.fit.H0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geepack/man/geeglm.html" class="external-link">geeglm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">response</span> <span class="op">~</span> <span class="va">item</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="va">logit</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">farmer1.gee</span>, na.action <span class="op">=</span> <span class="va">na.omit</span>, id <span class="op">=</span> <span class="va">case</span>,</span></span>
<span class="r-in"><span>  corstr <span class="op">=</span> <span class="st">"unstructured"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod.fit.HA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geepack/man/geeglm.html" class="external-link">geeglm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">response</span> <span class="op">~</span> <span class="va">Ed</span> <span class="op">*</span> <span class="va">item</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="va">logit</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">farmer1.gee</span>, na.action <span class="op">=</span> <span class="va">na.omit</span>, id <span class="op">=</span> <span class="va">case</span>,</span></span>
<span class="r-in"><span>  corstr <span class="op">=</span> <span class="st">"unstructured"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Compute Wald test</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod.fit.HA</span>, <span class="va">mod.fit.H0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of 'Wald statistic' Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1 response ~ Ed * item </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2 response ~ item</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Df     X2 P(&gt;|Chi|)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 20 33.183   0.03221 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://cyfs.unl.edu/personnel/bios/koziol-natalie.php" class="external-link">Natalie Koziol</a>, <a href="https://www.chrisbilder.com/" class="external-link">Chris Bilder</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

